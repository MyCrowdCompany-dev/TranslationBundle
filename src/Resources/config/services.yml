parameters:

services:

  # Custom data_collector to use our own template
  mcchappyr.translation.data_collector:
    class: Symfony\Component\Translation\DataCollector\TranslationDataCollector
    arguments: [ '@?translator.data_collector' ]
    tags:
      - { name: 'data_collector', template: "@HappyrTranslation/Profiler/translation", id: "translation", priority: 200 }

  mcchappyr.translation.service.blackhole:
    class: MyCrowdCompany\TranslationBundle\Service\Blackhole

  mcchappyr.translation.service.filesystem:
    class: MyCrowdCompany\TranslationBundle\Service\Filesystem
    arguments: ['@mcchappyr.translation.filesystem']

  mcchappyr.translation.filesystem:
    class: MyCrowdCompany\TranslationBundle\Translation\FilesystemUpdater
    arguments:
      - '@mcchappyr.translation.loader'
      - '@mcchappyr.translation.dumper'
      - ~
      - ~
      - ~
    tags:
      - { name: kernel.event_listener, event: kernel.terminate, method: onTerminate, priority: -20 }
      - { name: kernel.event_listener, event: console.terminate, method: onTerminate, priority: -20 }

  mcchappyr.translation.service.loco:
    class: MyCrowdCompany\TranslationBundle\Service\Loco
    arguments:
      - '@mcchappyr.translation.request_manager'
      - '@mcchappyr.translation.filesystem'
      - '@translator'
      - ~

  mcchappyr.translation.request_manager:
    class: MyCrowdCompany\TranslationBundle\Http\RequestManager
    arguments: [~, ~]
    public: false
